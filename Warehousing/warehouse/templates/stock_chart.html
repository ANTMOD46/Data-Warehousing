<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ ticker }} ‚Äî Stock Chart Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #2d1b4e 100%);
      color: #fff;
      padding: 20px;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Animated background particles */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 30%, rgba(138, 43, 226, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(65, 105, 225, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(72, 61, 139, 0.1) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
      animation: float 20s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(30px, -30px); }
    }

    .container {
      max-width: 1300px;
      margin: auto;
      position: relative;
      z-index: 1;
    }

    h2 {
      text-align: center;
      font-size: 2.5rem;
      background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 50%, #3b82f6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
      font-weight: 700;
      letter-spacing: -0.5px;
      animation: glow 3s ease-in-out infinite;
    }

    @keyframes glow {
      0%, 100% { filter: drop-shadow(0 0 20px rgba(167, 139, 250, 0.4)); }
      50% { filter: drop-shadow(0 0 30px rgba(96, 165, 250, 0.6)); }
    }

    .subtitle {
      text-align: center;
      font-size: 1rem;
      color: #a5b4fc;
      margin-bottom: 30px;
      font-weight: 300;
    }

    .controls-section {
      text-align: center;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(167, 139, 250, 0.2);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    select, button {
      padding: 10px 16px;
      border-radius: 10px;
      border: none;
      margin: 5px;
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    select {
      background: rgba(167, 139, 250, 0.15);
      color: #fff;
      border: 1px solid rgba(167, 139, 250, 0.3);
      cursor: pointer;
    }

    select:hover {
      background: rgba(167, 139, 250, 0.25);
      border-color: rgba(167, 139, 250, 0.5);
    }

    button {
      background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      border: none;
      box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(139, 92, 246, 0.6);
    }

    button:active {
      transform: translateY(0);
    }

    .timeframe-btn {
      padding: 8px 14px;
      border-radius: 10px;
      background: rgba(167, 139, 250, 0.1);
      color: #c4b5fd;
      cursor: pointer;
      border: 1px solid rgba(167, 139, 250, 0.2);
      font-weight: 500;
    }

    .timeframe-btn:hover {
      background: rgba(167, 139, 250, 0.2);
      border-color: rgba(167, 139, 250, 0.4);
    }

    .timeframe-btn.active {
      background: linear-gradient(135deg, #a78bfa 0%, #818cf8 100%);
      color: #fff;
      font-weight: 700;
      border-color: transparent;
      box-shadow: 0 4px 15px rgba(167, 139, 250, 0.5);
    }

    /* Summary Section */
    .summary-section {
      margin-top: 30px;
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(167, 139, 250, 0.2);
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .summary-section h3 {
      background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 20px;
      font-size: 1.6rem;
      text-align: center;
      font-weight: 700;
    }

    .summary-table {
      width: 100%;
      border-collapse: collapse;
      color: #e0e7ff;
      font-size: 0.95rem;
    }

    .summary-table th {
      text-align: left;
      background: rgba(167, 139, 250, 0.15);
      color: #c4b5fd;
      padding: 12px 15px;
      border-bottom: 2px solid rgba(167, 139, 250, 0.3);
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 0.5px;
    }

    .summary-table td {
      padding: 15px;
      border-bottom: 1px solid rgba(167, 139, 250, 0.1);
      vertical-align: top;
    }

    .summary-table tr {
      transition: all 0.3s ease;
    }

    .summary-table tr:hover {
      background: rgba(167, 139, 250, 0.08);
      transform: translateX(5px);
    }

    .summary-table .value {
      display: inline-block;
      background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 700;
      margin-top: 5px;
      font-size: 1.1rem;
    }

    /* Charts */
    .charts {
      margin-top: 30px;
      display: grid;
      gap: 25px;
    }

    .chart-card {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
      padding: 25px;
      border-radius: 20px;
      border: 1px solid rgba(167, 139, 250, 0.2);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
      animation: fadeInUp 0.6s ease-out;
    }

    .chart-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 40px rgba(139, 92, 246, 0.3);
      border-color: rgba(167, 139, 250, 0.4);
    }

    .chart-title {
      font-size: 1.3rem;
      background: linear-gradient(135deg, #a78bfa 0%, #60a5fa 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 10px;
      font-weight: 700;
    }

    .chart-desc {
      font-size: 0.9rem;
      color: #a5b4fc;
      margin-bottom: 15px;
      line-height: 1.6;
      padding-left: 10px;
      border-left: 3px solid rgba(167, 139, 250, 0.3);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #a78bfa 0%, #818cf8 100%);
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>üìà {{ ticker }} Stock Chart</h2>
    <div class="subtitle">
      ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏∏‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏ä‡∏µ‡πâ‡∏ß‡∏±‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô ClickHouse
    </div>

    <div class="controls-section">
      <select id="tickerSelect">
        {% for t in symbols %}
          <option value="{{ t }}" {% if t == ticker %}selected{% endif %}>{{ t }}</option>
        {% endfor %}
      </select>
      <button id="goBtn">‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü</button>

      {% for key in periods %}
        <button class="timeframe-btn {% if timeframe == key %}active{% endif %}"
                onclick="changePeriod('{{ key }}')">{{ key }}</button>
      {% endfor %}
    </div>

    <!-- Summary Section -->
    <div class="summary-section">
      <h3>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h3>
      <table class="summary-table">
        <thead>
          <tr>
            <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
            <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢</th>
            <th>‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏≠‡∏∞‡πÑ‡∏£</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>üìä <strong>‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á</strong><br><span class="value">{{ change_text }}</span></td>
            <td>‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</td>
            <td>‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏™‡∏±‡πâ‡∏ô</td>
          </tr>
          <tr>
            <td>üèîÔ∏è <strong>52W High</strong><br><span class="value">{{ high_52w|floatformat:2 }}</span></td>
            <td>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏õ‡∏µ</td>
            <td>‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß (‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà)</td>
          </tr>
          <tr>
            <td>üèîÔ∏è <strong>52W Low</strong><br><span class="value">{{ low_52w|floatformat:2 }}</span></td>
            <td>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏õ‡∏µ</td>
            <td>‡∏î‡∏π‡πÅ‡∏ô‡∏ß‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤</td>
          </tr>
          <tr>
            <td>üì¶ <strong>Avg Volume</strong><br><span class="value">{{ avg_volume|floatformat:2 }}M</span></td>
            <td>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</td>
            <td>‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏û‡∏Ñ‡∏•‡πà‡∏≠‡∏á</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Charts -->
    <div class="charts">
      <div class="chart-card">
        <div class="chart-title">üíπ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏∏‡πâ‡∏ô (Close Price)</div>
        <div class="chart-desc">
          ‡πÅ‡∏Å‡∏ô X = ‡∏ß‡∏±‡∏ô, ‡πÅ‡∏Å‡∏ô Y = ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏¥‡∏î (USD) ‡∏Ç‡∏≠‡∏á‡∏´‡∏∏‡πâ‡∏ô {{ ticker }} ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô  
          ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤‡∏õ‡∏¥‡∏î‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
        </div>
        <canvas id="priceChart" height="400"></canvas>
      </div>

      <div class="chart-card">
        <div class="chart-title">üìä ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢ (Volume)</div>
        <div class="chart-desc">
          ‡πÅ‡∏Å‡∏ô X = ‡∏ß‡∏±‡∏ô, ‡πÅ‡∏Å‡∏ô Y = ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏∏‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ß‡∏±‡∏ô  
          ‡∏ö‡∏≤‡∏£‡πå‡∏™‡∏π‡∏á‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏°‡∏≤‡∏Å (‡∏ô‡∏±‡∏Å‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡∏™‡∏π‡∏á)
        </div>
        <canvas id="volChart" height="200"></canvas>
      </div>

      <div class="chart-card">
        <div class="chart-title">üìà RSI (Relative Strength Index)</div>
        <div class="chart-desc">
          RSI ‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏ß‡∏±‡∏î "‡πÅ‡∏£‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏£‡∏á‡∏Ç‡∏≤‡∏¢"  
          ‡∏Ñ‡πà‡∏≤ RSI > 70 = ‡∏´‡∏∏‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏ã‡∏∑‡πâ‡∏≠‡∏°‡∏≤‡∏Å (Overbought)  
          ‡∏Ñ‡πà‡∏≤ RSI < 30 = ‡∏´‡∏∏‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏†‡∏≤‡∏ß‡∏∞‡∏Ç‡∏≤‡∏¢‡∏°‡∏≤‡∏Å (Oversold)
        </div>
        <canvas id="rsiChart" height="150"></canvas>
      </div>

      <div class="chart-card">
        <div class="chart-title">üìâ MACD (Moving Average Convergence Divergence)</div>
        <div class="chart-desc">
          MACD ‡∏ß‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏≤‡∏Ñ‡∏≤  
          - ‡πÄ‡∏™‡πâ‡∏ô MACD (‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß) = ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á EMA 12 ‡πÅ‡∏•‡∏∞ EMA 26  
          - ‡πÄ‡∏™‡πâ‡∏ô Signal (‡∏™‡∏µ‡πÅ‡∏î‡∏á) = EMA 9 ‡∏Ç‡∏≠‡∏á MACD  
          ‡πÄ‡∏°‡∏∑‡πà‡∏≠ MACD ‡∏ï‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ Signal ‚Üí ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ç‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô  
          ‡πÄ‡∏°‡∏∑‡πà‡∏≠ MACD ‡∏ï‡∏±‡∏î‡∏•‡∏á‡πÉ‡∏ï‡πâ Signal ‚Üí ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ç‡∏≤‡∏•‡∏á
        </div>
        <canvas id="macdChart" height="150"></canvas>
      </div>
    </div>
  </div>

  <script>
    const labels  = JSON.parse('{{ labels_json|escapejs }}');
    const closes  = JSON.parse('{{ closes_json|escapejs }}');
    const volumes = JSON.parse('{{ volumes_json|escapejs }}');
    const rsi     = JSON.parse('{{ rsi_json|escapejs }}');
    const macd    = JSON.parse('{{ macd_json|escapejs }}');
    const signal  = JSON.parse('{{ signal_json|escapejs }}');

    Chart.defaults.color = '#c4b5fd';
    Chart.defaults.borderColor = 'rgba(167, 139, 250, 0.2)';

    // Price Chart
    new Chart(document.getElementById("priceChart"), {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: 'Close Price',
          data: closes,
          borderColor: '#a78bfa',
          backgroundColor: 'rgba(167, 139, 250, 0.2)',
          fill: true,
          tension: 0.4,
          pointRadius: 0,
          borderWidth: 3
        }]
      },
      options: {
        plugins: { 
          legend: { 
            position: 'top',
            labels: { color: '#c4b5fd', font: { size: 14, weight: '600' } }
          }
        },
        scales: {
          x: { 
            title: { display: true, text: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', color: '#a5b4fc' },
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          },
          y: { 
            title: { display: true, text: '‡∏£‡∏≤‡∏Ñ‡∏≤ (USD)', color: '#a5b4fc' },
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          }
        }
      }
    });

    // Volume Chart
    new Chart(document.getElementById("volChart"), {
      type: 'bar',
      data: {
        labels,
        datasets: [{
          label: 'Volume',
          data: volumes,
          backgroundColor: 'rgba(96, 165, 250, 0.6)',
          borderColor: '#60a5fa',
          borderWidth: 1
        }]
      },
      options: {
        plugins: { legend: { display: false }},
        scales: {
          x: { 
            title: { display: true, text: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà', color: '#a5b4fc' },
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          },
          y: { 
            title: { display: true, text: '‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì (‡∏´‡∏∏‡πâ‡∏ô)', color: '#a5b4fc' },
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          }
        }
      }
    });

    // RSI Chart
    new Chart(document.getElementById("rsiChart"), {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: 'RSI (14)',
          data: rsi,
          borderColor: '#818cf8',
          backgroundColor: 'rgba(129, 140, 248, 0.1)',
          fill: true,
          tension: 0.3,
          pointRadius: 0,
          borderWidth: 2
        }]
      },
      options: {
        plugins: { 
          legend: { 
            position: 'top',
            labels: { color: '#c4b5fd', font: { size: 14, weight: '600' } }
          }
        },
        scales: { 
          y: { 
            min: 0, 
            max: 100, 
            title: { display: true, text: 'RSI (0‚Äì100)', color: '#a5b4fc' },
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          },
          x: {
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          }
        }
      }
    });

    // MACD Chart
    new Chart(document.getElementById("macdChart"), {
      type: 'line',
      data: {
        labels,
        datasets: [
          { 
            label: 'MACD', 
            data: macd, 
            borderColor: '#60a5fa', 
            tension: 0.3, 
            pointRadius: 0,
            borderWidth: 2
          },
          { 
            label: 'Signal', 
            data: signal, 
            borderColor: '#c084fc', 
            tension: 0.3, 
            pointRadius: 0,
            borderWidth: 2
          }
        ]
      },
      options: {
        plugins: { 
          legend: { 
            position: 'top',
            labels: { color: '#c4b5fd', font: { size: 14, weight: '600' } }
          }
        },
        scales: { 
          y: { 
            title: { display: true, text: 'MACD Value', color: '#a5b4fc' },
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          },
          x: {
            ticks: { color: '#a5b4fc' },
            grid: { color: 'rgba(167, 139, 250, 0.1)' }
          }
        }
      }
    });

    // Change ticker
    document.getElementById('goBtn').addEventListener('click', () => {
      const t = document.getElementById('tickerSelect').value;
      const url = new URL(window.location.href);
      url.pathname = `/ch/chart/${t}/`;
      window.location.href = url.toString();
    });

    // Change timeframe
    function changePeriod(period) {
      const t = document.getElementById('tickerSelect').value;
      window.location.href = `/ch/chart/${t}/?period=${period}`;
    }
  </script>
</body>
</html>